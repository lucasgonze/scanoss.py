name: Repo Version Tagging
# This workflow will read the version details from the repo and apply a branch

on:
  workflow_dispatch:
    inputs:
      run_for_real:
        required: true
        default: false
        type: boolean
        description: "Apply next tag (or Dry Run)"

jobs:
  version-tag:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: '0'
      - name: Set up Python
        uses: actions/setup-python@v3
        with:
          python-version: '3.10.x'
      - name: Determine Tag
        id: taggerVersion
        run: |
          app_version=$(tools/get_next_version.sh)
          echo "python_app_version=$app_version" >> $GITHUB_ENV

      - name: Run Tagging
        if: ${{ inputs.run_for_real }}
        id: taggerApply
        run: |
          echo "Applying tag ${{env.python_app_version}} ..."
          git tag "test-${{env.python_app_version}}"
          echo "Pushing changes..."
          git push --tags

#          git config --global user.name 'SCANOSS'
#          git config --global user.email 'infra@scanoss.com'

